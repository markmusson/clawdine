# 2026-02-10

## OpenClaw Security Audit - Disclosure Preparation

Completed comprehensive security audit yesterday, sub-agent found 4 high/medium vulnerabilities. Today: formatted all findings for responsible disclosure to OpenClaw security team.

### Disclosures Ready to File

All formatted according to OpenClaw's `SECURITY.md` requirements (8 mandatory elements each):

**1. VULN-188: Default Admin Scope (High)**
- `src/gateway/server/ws-connection/message-handler.ts:360-366`
- Clients without explicit scopes granted `operator.admin` by default
- Fix: Reject empty scopes or default to least-privilege

**2. VULN-210: NPM Scripts RCE (High)**
- `src/plugins/install.ts:277-284`
- Plugin installs run `npm install` without `--ignore-scripts`
- Supply chain attack vector via malicious postinstall scripts
- Fix: Add `--ignore-scripts` flag

**3. Zip Slip: Path Traversal (High)**
- `src/agents/skills-install.ts:255-278`
- Archive extraction via shell commands (tar/unzip) doesn't validate paths
- Malicious archives can write `../../.bashrc`, `../../.ssh/authorized_keys`
- Fix: Replace with safe extraction libraries (tar npm package with path validation)

**4. SSRF: URL Inputs Allow Internal Network Access (High/Medium)**
- `src/gateway/openresponses-http.ts:102-118`
- `src/media/input-files.ts:139-150`
- `src/infra/net/fetch-guard.ts:101-125`
- URLs enabled by default, fetch guard doesn't block private networks
- Can access 169.254.169.254 (AWS metadata), localhost, RFC1918
- Fix: Default `allowUrl: false`, enforce SSRF policy with `allowPrivateNetwork: false`

### Disclosure Package

Created 5 files in `disclosures/`:
- `VULN-188-disclosure.md` (2.9K)
- `VULN-210-disclosure.md` (3.7K)
- `ZIP-SLIP-disclosure.md` (4.8K)
- `SSRF-disclosure.md` (6.2K)
- `MASTER-DISCLOSURE-EMAIL.md` (5.0K) â€” Cover email tying it all together

Each disclosure includes:
- Title, severity, impact, affected component
- File paths with exact line numbers
- Technical reproduction steps with code samples
- Demonstrated attack scenarios
- CWE/OWASP mappings
- Concrete remediation advice with working fixes
- Testing guidance

### Reporting Process

Per OpenClaw `SECURITY.md`:
- **Primary:** GitHub private security advisories (if enabled)
- **Fallback:** Email to `security@openclaw.ai`
- **Security Lead:** Jamieson O'Reilly (@theonejvo, founder of Dvuln)
- **Policy:** No bug bounty, prefer PRs with fixes
- **Timeline:** Standard 90 days coordinated disclosure

Ready to file. Mark asking about reporting process now.

### Context

This audit supports ClawdSure's threat modeling and product validation. Live proof chain (Agent #001: CLWD-3F8B0233) already includes `skills.pattern_scan` audit check that would catch VULN-210 lifecycle script attacks.

**Potential integration:** Use these real vulnerabilities in ClawdSure marketing to show how attestation chain would detect/prevent them. Especially VULN-210 (supply chain) maps directly to machine audit capabilities.

---

## Next: File Disclosures

Mark wants to report these properly. Options:
1. Email `security@openclaw.ai` with all 5 markdown files attached
2. Check if GitHub private security advisories enabled, file there
3. Offer to write PRs with fixes

Awaiting Mark's call on which route.
