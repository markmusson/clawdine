# TrustGraph (Local Threat Intel KG)

> Scope: **threat intelligence only** for ClawHub skills. No prediction markets.

## Status
- **Docker not installed** on this host (`docker` command not found). TrustGraph **not started yet**.
- Seed data generated from local skills + `clawdsure.bak/threats.json`:
  - `trustgraph/seed/seed.jsonl`
  - `trustgraph/seed/summary.json`

## Local Setup (Docker Compose)
Based on TrustGraph docs: https://docs.trustgraph.ai/deployment/compose
Reference repo: https://github.com/trustgraph-ai/trustgraph

### 1) Install prerequisites
- **Docker Engine** (recommended on macOS) or Podman
- **Python 3.11+** for CLI tools

Verify:
```bash
python3 --version
# docker --version   # currently missing on this host
```

### 2) Build deployment config
Use the configuration builder: https://config-ui.demo.trustgraph.ai/

Required selections:
- **Deployment:** Docker Compose (local)
- **Graph Store:** Cassandra (default)
- **Vector DB:** Qdrant (default)
- **LLM:** OpenAI
- **Chunker:** Recursive (default)

Download the ZIP (deployment bundle) and unzip into this directory:
```bash
mkdir -p ~/trustgraph
cd ~/trustgraph
unzip ~/Downloads/deploy.zip
```

### 3) Install TrustGraph CLI
Use the version that matches the config bundle:
```bash
python3 -m venv env
. env/bin/activate
pip install trustgraph-cli==<VERSION_FROM_BUILDER>
```

### 4) Configure OpenAI env
```bash
export OPENAI_API_KEY="..."
```

### 5) Start TrustGraph
From the unzipped deployment folder:
```bash
docker compose up -d
```
Workbench UI (default): http://localhost:8888

---

## Ontology (ClawHub Skill Threat Intel)

### Entities
- **Skill**: `name`, `version`, `author`, `source_url`
- **Package**: `name`, `version`, `registry`
- **Threat**: `id`, `type`, `severity`, `description`, `date`
- **Author**: `name`, `platform_id`
- **Source**: `url`, `platform`

### Relationships
- **DEPENDS_ON**: Skill → Package
- **HAS_KNOWN_THREAT**: Skill → Threat
- **PUBLISHED_BY**: Skill → Author
- **REPORTED_BY**: Threat → Source
- **MITIGATED_BY**: Threat → Package or Skill (where relevant)
- **AFFECTS**: Threat → Skill or Package

---

## Seed Data (Generated)
A minimal seed set was generated from local skills + ClawdSure threats.

**Generated by:** `trustgraph/build_seed.py`

Outputs:
- `trustgraph/seed/seed.jsonl` — nodes + edges
- `trustgraph/seed/summary.json` — scan summary

### Current scan summary
- Skills: 4
- Threats: 1
- Nodes: 5
- Edges: 1 (Threat → Source via REPORTED_BY)

### Notes
- Skill metadata is limited to `SKILL.md` front-matter and headings. No dependency manifests were found, so **DEPENDS_ON** edges are not present yet.
- `clawdsure.bak/threats.json` contained one threat record. It was ingested as a **Threat** node plus a **Source** node with a **REPORTED_BY** edge.

---

## Ingesting into TrustGraph
Once TrustGraph is running, use the Workbench or CLI to create a schema matching the ontology and import `seed.jsonl`.

Suggested flow (Workbench):
1. **Schemas → Create Schema** (define entities + relationships as above)
2. **Library → Import** the `seed/seed.jsonl` dataset
3. Verify via **Relationships** or **Graph Visualizer**

If you prefer CLI ingestion, consult: https://docs.trustgraph.ai/reference

---

## Next Steps (Blocked)
- Install Docker Engine on this host
- Generate TrustGraph deployment bundle via config builder
- Start Docker compose
- Import seed data into the running instance
